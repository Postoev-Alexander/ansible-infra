services:
  postgres:
    image: postgres:17.6
    container_name: "{{ postgres_project_name }}"
    restart: always
    ports:
      - "5432:5432"
    environment:
      POSTGRES_DB: "{{ postgres_db_name }}"
      POSTGRES_USER: "{{ postgres_db_user }}"
      POSTGRES_PASSWORD: "{{ postgres_db_password }}"
    volumes:
      - "{{ postgres_volume_name }}:/var/lib/postgresql/data"
      - "{{ postgres_config_path }}/certs/server.crt:/etc/ssl/certs/server.crt:ro"
      - "{{ postgres_config_path }}/certs/server.key:/etc/ssl/private/server.key:ro"
      #  скрипт с настройками - в специальную папку для инициализации
      - "{{ postgres_config_path }}/custom-settings.sql:/docker-entrypoint-initdb.d/custom-settings.sql:ro"

volumes:
  "{{ postgres_volume_name }}":
    external: true